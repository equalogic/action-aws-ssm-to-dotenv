{"version":3,"file":"resolveProcessCredentials.js","sources":["../../../../../node_modules/@aws-sdk/credential-provider-process/dist-es/resolveProcessCredentials.js"],"sourcesContent":["import { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { exec } from \"child_process\";\nimport { promisify } from \"util\";\nimport { getValidatedProcessCredentials } from \"./getValidatedProcessCredentials\";\nexport const resolveProcessCredentials = async (profileName, profiles, logger) => {\n    const profile = profiles[profileName];\n    if (profiles[profileName]) {\n        const credentialProcess = profile[\"credential_process\"];\n        if (credentialProcess !== undefined) {\n            const execPromise = promisify(exec);\n            try {\n                const { stdout } = await execPromise(credentialProcess);\n                let data;\n                try {\n                    data = JSON.parse(stdout.trim());\n                }\n                catch {\n                    throw Error(`Profile ${profileName} credential_process returned invalid JSON.`);\n                }\n                return getValidatedProcessCredentials(profileName, data, profiles);\n            }\n            catch (error) {\n                throw new CredentialsProviderError(error.message, { logger });\n            }\n        }\n        else {\n            throw new CredentialsProviderError(`Profile ${profileName} did not contain credential_process.`, { logger });\n        }\n    }\n    else {\n        throw new CredentialsProviderError(`Profile ${profileName} could not be found in shared credentials file.`, {\n            logger,\n        });\n    }\n};\n"],"names":[],"mappings":";;;;;AAIY,MAAC,yBAAyB,GAAG,OAAO,WAAW,EAAE,QAAQ,EAAE,MAAM,KAAK;AAClF,IAAI,MAAM,OAAO,GAAG,QAAQ,CAAC,WAAW,CAAC;AACzC,IAAI,IAAI,QAAQ,CAAC,WAAW,CAAC,EAAE;AAC/B,QAAQ,MAAM,iBAAiB,GAAG,OAAO,CAAC,oBAAoB,CAAC;AAC/D,QAAQ,IAAI,iBAAiB,KAAK,SAAS,EAAE;AAC7C,YAAY,MAAM,WAAW,GAAG,SAAS,CAAC,IAAI,CAAC;AAC/C,YAAY,IAAI;AAChB,gBAAgB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,WAAW,CAAC,iBAAiB,CAAC;AACvE,gBAAgB,IAAI,IAAI;AACxB,gBAAgB,IAAI;AACpB,oBAAoB,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AACpD,gBAAgB;AAChB,gBAAgB,MAAM;AACtB,oBAAoB,MAAM,KAAK,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,0CAA0C,CAAC,CAAC;AACnG,gBAAgB;AAChB,gBAAgB,OAAO,8BAA8B,CAAC,WAAW,EAAE,IAAI,EAAE,QAAQ,CAAC;AAClF,YAAY;AACZ,YAAY,OAAO,KAAK,EAAE;AAC1B,gBAAgB,MAAM,IAAI,wBAAwB,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC;AAC7E,YAAY;AACZ,QAAQ;AACR,aAAa;AACb,YAAY,MAAM,IAAI,wBAAwB,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,oCAAoC,CAAC,EAAE,EAAE,MAAM,EAAE,CAAC;AACxH,QAAQ;AACR,IAAI;AACJ,SAAS;AACT,QAAQ,MAAM,IAAI,wBAAwB,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,+CAA+C,CAAC,EAAE;AACpH,YAAY,MAAM;AAClB,SAAS,CAAC;AACV,IAAI;AACJ;;;;","x_google_ignoreList":[0]}