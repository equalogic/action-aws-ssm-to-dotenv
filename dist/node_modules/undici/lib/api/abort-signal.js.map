{"version":3,"file":"abort-signal.js","sources":["../../../../../node_modules/undici/lib/api/abort-signal.js"],"sourcesContent":["const { addAbortListener } = require('../core/util')\nconst { RequestAbortedError } = require('../core/errors')\n\nconst kListener = Symbol('kListener')\nconst kSignal = Symbol('kSignal')\n\nfunction abort (self) {\n  if (self.abort) {\n    self.abort()\n  } else {\n    self.onError(new RequestAbortedError())\n  }\n}\n\nfunction addSignal (self, signal) {\n  self[kSignal] = null\n  self[kListener] = null\n\n  if (!signal) {\n    return\n  }\n\n  if (signal.aborted) {\n    abort(self)\n    return\n  }\n\n  self[kSignal] = signal\n  self[kListener] = () => {\n    abort(self)\n  }\n\n  addAbortListener(self[kSignal], self[kListener])\n}\n\nfunction removeSignal (self) {\n  if (!self[kSignal]) {\n    return\n  }\n\n  if ('removeEventListener' in self[kSignal]) {\n    self[kSignal].removeEventListener('abort', self[kListener])\n  } else {\n    self[kSignal].removeListener('abort', self[kListener])\n  }\n\n  self[kSignal] = null\n  self[kListener] = null\n}\n\nmodule.exports = {\n  addSignal,\n  removeSignal\n}\n"],"names":["require$$0","require$$1"],"mappings":";;;;;;;;;CAAA,MAAM,EAAE,gBAAgB,EAAE,GAAGA,WAAA;CAC7B,MAAM,EAAE,mBAAmB,EAAE,GAAGC,aAAA;;AAEhC,CAAA,MAAM,SAAS,GAAG,MAAM,CAAC,WAAW;AACpC,CAAA,MAAM,OAAO,GAAG,MAAM,CAAC,SAAS;;CAEhC,SAAS,KAAK,EAAE,IAAI,EAAE;AACtB,GAAE,IAAI,IAAI,CAAC,KAAK,EAAE;KACd,IAAI,CAAC,KAAK;AACd,GAAA,CAAG,MAAM;AACT,KAAI,IAAI,CAAC,OAAO,CAAC,IAAI,mBAAmB,EAAE;AAC1C,GAAA;AACA,CAAA;;AAEA,CAAA,SAAS,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE;AAClC,GAAE,IAAI,CAAC,OAAO,CAAC,GAAG;AAClB,GAAE,IAAI,CAAC,SAAS,CAAC,GAAG;;GAElB,IAAI,CAAC,MAAM,EAAE;KACX;AACJ,GAAA;;AAEA,GAAE,IAAI,MAAM,CAAC,OAAO,EAAE;KAClB,KAAK,CAAC,IAAI;KACV;AACJ,GAAA;;AAEA,GAAE,IAAI,CAAC,OAAO,CAAC,GAAG;AAClB,GAAE,IAAI,CAAC,SAAS,CAAC,GAAG,MAAM;KACtB,KAAK,CAAC,IAAI;AACd,GAAA;;GAEE,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC;AACjD,CAAA;;CAEA,SAAS,YAAY,EAAE,IAAI,EAAE;AAC7B,GAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;KAClB;AACJ,GAAA;;AAEA,GAAE,IAAI,qBAAqB,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE;AAC9C,KAAI,IAAI,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC;AAC9D,GAAA,CAAG,MAAM;AACT,KAAI,IAAI,CAAC,OAAO,CAAC,CAAC,cAAc,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC;AACzD,GAAA;;AAEA,GAAE,IAAI,CAAC,OAAO,CAAC,GAAG;AAClB,GAAE,IAAI,CAAC,SAAS,CAAC,GAAG;AACpB,CAAA;;AAEA,CAAA,WAAc,GAAG;AACjB,GAAE,SAAS;GACT;AACF;;;;;;","x_google_ignoreList":[0]}