{"version":3,"file":"staticStabilityProvider.js","sources":["../../../../../../node_modules/@smithy/credential-provider-imds/dist-es/utils/staticStabilityProvider.js"],"sourcesContent":["import { getExtendedInstanceMetadataCredentials } from \"./getExtendedInstanceMetadataCredentials\";\nexport const staticStabilityProvider = (provider, options = {}) => {\n    const logger = options?.logger || console;\n    let pastCredentials;\n    return async () => {\n        let credentials;\n        try {\n            credentials = await provider();\n            if (credentials.expiration && credentials.expiration.getTime() < Date.now()) {\n                credentials = getExtendedInstanceMetadataCredentials(credentials, logger);\n            }\n        }\n        catch (e) {\n            if (pastCredentials) {\n                logger.warn(\"Credential renew failed: \", e);\n                credentials = getExtendedInstanceMetadataCredentials(pastCredentials, logger);\n            }\n            else {\n                throw e;\n            }\n        }\n        pastCredentials = credentials;\n        return credentials;\n    };\n};\n"],"names":[],"mappings":";;AACY,MAAC,uBAAuB,GAAG,CAAC,QAAQ,EAAE,OAAO,GAAG,EAAE,KAAK;AACnE,IAAI,MAAM,MAAM,GAAG,OAAO,EAAE,MAAM,IAAI,OAAO;AAC7C,IAAI,IAAI,eAAe;AACvB,IAAI,OAAO,YAAY;AACvB,QAAQ,IAAI,WAAW;AACvB,QAAQ,IAAI;AACZ,YAAY,WAAW,GAAG,MAAM,QAAQ,EAAE;AAC1C,YAAY,IAAI,WAAW,CAAC,UAAU,IAAI,WAAW,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,GAAG,EAAE,EAAE;AACzF,gBAAgB,WAAW,GAAG,sCAAsC,CAAC,WAAW,EAAE,MAAM,CAAC;AACzF,YAAY;AACZ,QAAQ;AACR,QAAQ,OAAO,CAAC,EAAE;AAClB,YAAY,IAAI,eAAe,EAAE;AACjC,gBAAgB,MAAM,CAAC,IAAI,CAAC,2BAA2B,EAAE,CAAC,CAAC;AAC3D,gBAAgB,WAAW,GAAG,sCAAsC,CAAC,eAAe,EAAE,MAAM,CAAC;AAC7F,YAAY;AACZ,iBAAiB;AACjB,gBAAgB,MAAM,CAAC;AACvB,YAAY;AACZ,QAAQ;AACR,QAAQ,eAAe,GAAG,WAAW;AACrC,QAAQ,OAAO,WAAW;AAC1B,IAAI,CAAC;AACL;;;;","x_google_ignoreList":[0]}