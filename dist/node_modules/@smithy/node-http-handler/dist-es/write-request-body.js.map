{"version":3,"file":"write-request-body.js","sources":["../../../../../node_modules/@smithy/node-http-handler/dist-es/write-request-body.js"],"sourcesContent":["import { Readable } from \"stream\";\nimport { timing } from \"./timing\";\nconst MIN_WAIT_TIME = 6000;\nexport async function writeRequestBody(httpRequest, request, maxContinueTimeoutMs = MIN_WAIT_TIME) {\n    const headers = request.headers ?? {};\n    const expect = headers[\"Expect\"] || headers[\"expect\"];\n    let timeoutId = -1;\n    let sendBody = true;\n    if (expect === \"100-continue\") {\n        sendBody = await Promise.race([\n            new Promise((resolve) => {\n                timeoutId = Number(timing.setTimeout(() => resolve(true), Math.max(MIN_WAIT_TIME, maxContinueTimeoutMs)));\n            }),\n            new Promise((resolve) => {\n                httpRequest.on(\"continue\", () => {\n                    timing.clearTimeout(timeoutId);\n                    resolve(true);\n                });\n                httpRequest.on(\"response\", () => {\n                    timing.clearTimeout(timeoutId);\n                    resolve(false);\n                });\n                httpRequest.on(\"error\", () => {\n                    timing.clearTimeout(timeoutId);\n                    resolve(false);\n                });\n            }),\n        ]);\n    }\n    if (sendBody) {\n        writeBody(httpRequest, request.body);\n    }\n}\nfunction writeBody(httpRequest, body) {\n    if (body instanceof Readable) {\n        body.pipe(httpRequest);\n        return;\n    }\n    if (body) {\n        if (Buffer.isBuffer(body) || typeof body === \"string\") {\n            httpRequest.end(body);\n            return;\n        }\n        const uint8 = body;\n        if (typeof uint8 === \"object\" &&\n            uint8.buffer &&\n            typeof uint8.byteOffset === \"number\" &&\n            typeof uint8.byteLength === \"number\") {\n            httpRequest.end(Buffer.from(uint8.buffer, uint8.byteOffset, uint8.byteLength));\n            return;\n        }\n        httpRequest.end(Buffer.from(body));\n        return;\n    }\n    httpRequest.end();\n}\n"],"names":[],"mappings":";;;AAEA,MAAM,aAAa,GAAG,IAAI;AACnB,eAAe,gBAAgB,CAAC,WAAW,EAAE,OAAO,EAAE,oBAAoB,GAAG,aAAa,EAAE;AACnG,IAAI,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,EAAE;AACzC,IAAI,MAAM,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC;AACzD,IAAI,IAAI,SAAS,GAAG,EAAE;AACtB,IAAI,IAAI,QAAQ,GAAG,IAAI;AACvB,IAAI,IAAI,MAAM,KAAK,cAAc,EAAE;AACnC,QAAQ,QAAQ,GAAG,MAAM,OAAO,CAAC,IAAI,CAAC;AACtC,YAAY,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK;AACrC,gBAAgB,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,oBAAoB,CAAC,CAAC,CAAC;AACzH,YAAY,CAAC,CAAC;AACd,YAAY,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK;AACrC,gBAAgB,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,MAAM;AACjD,oBAAoB,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC;AAClD,oBAAoB,OAAO,CAAC,IAAI,CAAC;AACjC,gBAAgB,CAAC,CAAC;AAClB,gBAAgB,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,MAAM;AACjD,oBAAoB,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC;AAClD,oBAAoB,OAAO,CAAC,KAAK,CAAC;AAClC,gBAAgB,CAAC,CAAC;AAClB,gBAAgB,WAAW,CAAC,EAAE,CAAC,OAAO,EAAE,MAAM;AAC9C,oBAAoB,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC;AAClD,oBAAoB,OAAO,CAAC,KAAK,CAAC;AAClC,gBAAgB,CAAC,CAAC;AAClB,YAAY,CAAC,CAAC;AACd,SAAS,CAAC;AACV,IAAI;AACJ,IAAI,IAAI,QAAQ,EAAE;AAClB,QAAQ,SAAS,CAAC,WAAW,EAAE,OAAO,CAAC,IAAI,CAAC;AAC5C,IAAI;AACJ;AACA,SAAS,SAAS,CAAC,WAAW,EAAE,IAAI,EAAE;AACtC,IAAI,IAAI,IAAI,YAAY,QAAQ,EAAE;AAClC,QAAQ,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;AAC9B,QAAQ;AACR,IAAI;AACJ,IAAI,IAAI,IAAI,EAAE;AACd,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AAC/D,YAAY,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC;AACjC,YAAY;AACZ,QAAQ;AACR,QAAQ,MAAM,KAAK,GAAG,IAAI;AAC1B,QAAQ,IAAI,OAAO,KAAK,KAAK,QAAQ;AACrC,YAAY,KAAK,CAAC,MAAM;AACxB,YAAY,OAAO,KAAK,CAAC,UAAU,KAAK,QAAQ;AAChD,YAAY,OAAO,KAAK,CAAC,UAAU,KAAK,QAAQ,EAAE;AAClD,YAAY,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC;AAC1F,YAAY;AACZ,QAAQ;AACR,QAAQ,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC1C,QAAQ;AACR,IAAI;AACJ,IAAI,WAAW,CAAC,GAAG,EAAE;AACrB;;;;","x_google_ignoreList":[0]}